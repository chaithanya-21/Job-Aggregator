<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Job Aggregator</title>

<style>
:root{--primary:#0a66c2;--radius:8px}
body{margin:0;font-family:Segoe UI;background:#eef3f8}
.header{background:white;padding:20px 40px;box-shadow:0 2px 8px rgba(0,0,0,0.06)}
.logo{font-size:22px;font-weight:600;color:var(--primary);margin-bottom:12px}
.search{display:flex;gap:12px;flex-wrap:wrap}
select,button{padding:11px 14px;font-size:15px;border-radius:6px;border:1px solid #ddd}
button{background:var(--primary);color:white;border:none;cursor:pointer}
.container{padding:30px 40px;max-width:900px;margin:auto}
.job{background:white;border-radius:var(--radius);padding:18px;margin-bottom:14px;
box-shadow:0 2px 6px rgba(0,0,0,0.08)}
.title{font-size:18px;font-weight:600;color:var(--primary)}
.apply{display:inline-block;margin-top:10px;padding:8px 14px;background:#057642;color:white;text-decoration:none;border-radius:5px}
</style>
</head>

<body>

<div class="header">
<div class="logo">Job Aggregator</div>

<div class="search">
<select id="role">
<option>Business Analyst</option>
<option>Consultant</option>
<option>AI Engineer</option>
<option>Data Scientist</option>
<option>Project Manager</option>
<option>Product Manager</option>
</select>

<select id="country">
<option>India</option>
<option>United States</option>
<option>United Kingdom</option>
<option>Australia</option>
<option>Canada</option>
</select>

<select id="mode">
<option>All</option>
<option>WFH</option>
<option>Hybrid</option>
<option>Office</option>
</select>

<button onclick="loadJobs(1)">Search</button>
</div>
</div>

<div class="container">
<div id="jobs"></div>
</div>

<script>

let settings={};

async function loadSettings(){
const res=await fetch("/settings");
settings=await res.json();

document.querySelector(".logo").innerText=settings.siteTitle;
document.documentElement.style.setProperty('--primary',settings.primaryColor);
document.documentElement.style.setProperty('--radius',settings.cardRadius+"px");
}

async function loadJobs(page){

const role=role.value;
const country=country.value;
const mode=mode.value;

const res=await fetch(`/api/jobs?role=${role}&country=${country}&mode=${mode}&page=${page}`);
const jobs=await res.json();

jobsDiv.innerHTML="";

jobs.forEach(j=>{
const card=document.createElement("div");
card.className="job";

card.innerHTML=`
<div class="title">${j.title}</div>
<div>${j.company}</div>
<div>${j.state}, ${j.country}</div>
${settings.showMode?`<div>${j.mode}</div>`:""}
${settings.showSalary?`<div>Salary: ${j.salary}</div>`:""}
<a class="apply" href="${j.source}" target="_blank">Apply</a>`;

jobsDiv.appendChild(card);
});
}

loadSettings().then(()=>loadJobs(1));

</script>

</body>
</html>
